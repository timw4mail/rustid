name: Release Binaries
on:
    push:
        tags:
            - "v*"
jobs:
    generate:
        name: Create release artifacts
        runs-on: ubuntu-latest
        # needs: [create_release]
        steps:
            - name: Checkout code
              uses: actions/checkout@master
            - name: Install just
              run: |
                  curl -fsSL https://just.systems/install.sh | bash -s -- --to /usr/local/bin
            - name: Build dos
              run: just build-dos
            - name: Upload artifact
              uses: actions/upload-artifact@v5
              with:
                  name: rustid
                  path: ./rustid.com
            - name: Upload binaries to release
              uses: actions/download-artifact@v5
              with:
                  name: rustid
                  path: ./rustid.com
            - name: Publish binaries
              run: |
                  gh release create --generate-notes ${{ github.ref.name }} './rustid.com#DOS binary'

