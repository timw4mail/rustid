name: Release Binaries
on:
    push:
        tags:
            - "v*"
jobs:
    generate:
        name: Create release artifacts
        runs-on: ubuntu-latest
        needs: [create_release]
        steps:
            - name: Checkout code
              uses: actions/checkout@v2
            - name: Install just
              run: |
                  curl -fsSL https://just.systems/install.sh | bash -s -- --to /usr/local/bin
            - name: Build dos
              run: just build-dos
            - name: Upload binaries to release
              uses: skx/github-action-publish-binaries@release-2.0
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              with:
                  releaseId: ${{ needs.create_release.outputs.id }}
                  args: rustid.com